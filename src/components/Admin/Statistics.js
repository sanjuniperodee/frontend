import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useQuery } from '@tanstack/react-query';
import { Users, MapPin, MessageSquare } from 'lucide-react';
export default function Statistics() {
    const { data: stats, isLoading } = useQuery({
        queryKey: ['admin-statistics'],
        queryFn: async () => {
            const response = await fetch('/api/admin/statistics');
            if (!response.ok)
                throw new Error('Failed to fetch statistics');
            return response.json();
        },
    });
    if (isLoading) {
        return (_jsx("div", { className: "flex items-center justify-center h-full", children: _jsx("div", { className: "text-gray-600", children: "\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0438..." }) }));
    }
    return (_jsxs("div", { className: "space-y-6", children: [_jsxs("div", { className: "grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3", children: [_jsx("div", { className: "bg-white overflow-hidden shadow rounded-lg", children: _jsx("div", { className: "p-5", children: _jsxs("div", { className: "flex items-center", children: [_jsx("div", { className: "flex-shrink-0", children: _jsx(Users, { className: "h-6 w-6 text-gray-400" }) }), _jsx("div", { className: "ml-5 w-0 flex-1", children: _jsxs("dl", { children: [_jsx("dt", { className: "text-sm font-medium text-gray-500 truncate", children: "\u0412\u0441\u0435\u0433\u043E \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439" }), _jsxs("dd", { className: "flex items-baseline", children: [_jsx("div", { className: "text-2xl font-semibold text-gray-900", children: stats?.totalUsers }), _jsxs("div", { className: "ml-2 flex items-baseline text-sm font-semibold text-green-600", children: [stats?.activeUsers, " \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0445"] })] })] }) })] }) }) }), _jsx("div", { className: "bg-white overflow-hidden shadow rounded-lg", children: _jsx("div", { className: "p-5", children: _jsxs("div", { className: "flex items-center", children: [_jsx("div", { className: "flex-shrink-0", children: _jsx(MapPin, { className: "h-6 w-6 text-gray-400" }) }), _jsx("div", { className: "ml-5 w-0 flex-1", children: _jsxs("dl", { children: [_jsx("dt", { className: "text-sm font-medium text-gray-500 truncate", children: "\u0412\u0441\u0435\u0433\u043E \u043C\u0435\u0442\u043E\u043A" }), _jsxs("dd", { className: "flex items-baseline", children: [_jsx("div", { className: "text-2xl font-semibold text-gray-900", children: stats?.totalMarkers }), _jsxs("div", { className: "ml-2 flex items-baseline text-sm font-semibold text-yellow-600", children: [stats?.pendingMarkers, " \u043D\u0430 \u043C\u043E\u0434\u0435\u0440\u0430\u0446\u0438\u0438"] })] })] }) })] }) }) }), _jsx("div", { className: "bg-white overflow-hidden shadow rounded-lg", children: _jsx("div", { className: "p-5", children: _jsxs("div", { className: "flex items-center", children: [_jsx("div", { className: "flex-shrink-0", children: _jsx(MessageSquare, { className: "h-6 w-6 text-gray-400" }) }), _jsx("div", { className: "ml-5 w-0 flex-1", children: _jsxs("dl", { children: [_jsx("dt", { className: "text-sm font-medium text-gray-500 truncate", children: "\u0412\u0441\u0435\u0433\u043E \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0435\u0432" }), _jsx("dd", { className: "text-2xl font-semibold text-gray-900", children: stats?.totalComments })] }) })] }) }) })] }), _jsxs("div", { className: "bg-white shadow rounded-lg p-6", children: [_jsx("h3", { className: "text-lg font-medium text-gray-900 mb-4", children: "\u0420\u0430\u0441\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u0438\u0435 \u043F\u043E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F\u043C" }), _jsx("div", { className: "space-y-4", children: stats?.categoriesStats.map((category) => (_jsxs("div", { children: [_jsxs("div", { className: "flex justify-between text-sm font-medium text-gray-900", children: [_jsx("span", { children: category.categoryName }), _jsx("span", { children: category.count })] }), _jsx("div", { className: "mt-1 relative pt-1", children: _jsx("div", { className: "overflow-hidden h-2 text-xs flex rounded bg-gray-200", children: _jsx("div", { style: {
                                                width: `${(category.count / stats.totalMarkers) * 100}%`,
                                            }, className: "shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500" }) }) })] }, category.categoryId))) })] }), _jsxs("div", { className: "bg-white shadow rounded-lg p-6", children: [_jsx("h3", { className: "text-lg font-medium text-gray-900 mb-4", children: "\u0422\u043E\u043F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439" }), _jsx("div", { className: "overflow-x-auto", children: _jsxs("table", { className: "min-w-full divide-y divide-gray-200", children: [_jsx("thead", { className: "bg-gray-50", children: _jsxs("tr", { children: [_jsx("th", { className: "px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider", children: "\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C" }), _jsx("th", { className: "px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider", children: "\u041C\u0435\u0442\u043A\u0438" }), _jsx("th", { className: "px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider", children: "\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0438" })] }) }), _jsx("tbody", { className: "bg-white divide-y divide-gray-200", children: stats?.userStats.map((user) => (_jsxs("tr", { children: [_jsx("td", { className: "px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900", children: user.username }), _jsx("td", { className: "px-6 py-4 whitespace-nowrap text-sm text-gray-500", children: user.markersCount }), _jsx("td", { className: "px-6 py-4 whitespace-nowrap text-sm text-gray-500", children: user.commentsCount })] }, user.userId))) })] }) })] }), _jsxs("div", { className: "bg-white shadow rounded-lg p-6", children: [_jsx("h3", { className: "text-lg font-medium text-gray-900 mb-4", children: "\u0415\u0436\u0435\u0434\u043D\u0435\u0432\u043D\u0430\u044F \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u044C" }), _jsx("div", { className: "h-64", children: _jsx("div", { className: "flex h-full items-end space-x-2", children: stats?.dailyActivity.map((day) => (_jsxs("div", { className: "flex-1 flex flex-col items-center", children: [_jsx("div", { style: { height: `${(day.markers / 10) * 100}%` }, className: "w-full bg-blue-500 rounded-t" }), _jsx("div", { className: "text-xs text-gray-500 mt-1", children: new Date(day.date).toLocaleDateString('ru-RU', {
                                            day: 'numeric',
                                            month: 'short',
                                        }) })] }, day.date))) }) })] })] }));
}
